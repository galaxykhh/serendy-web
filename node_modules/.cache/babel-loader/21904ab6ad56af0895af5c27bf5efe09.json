{"ast":null,"code":"import { action, makeObservable, observable, runInAction } from 'mobx';\nimport userStore from './userStore';\nimport postRespository from '../repository/postRepository';\n\nclass PostStore {\n  constructor() {\n    this.sentPosts = [];\n    this.receivedPosts = [];\n    this.currentSentPost = null;\n    this.currentReceivedPost = null;\n    makeObservable(this, {\n      sentPosts: observable,\n      receivedPosts: observable,\n      currentSentPost: observable,\n      currentReceivedPost: observable,\n      setSentPosts: action,\n      setReceivedPosts: action,\n      setCurrentSentPost: action,\n      setCurrentReceivedPost: action,\n      handlePost: action,\n      getSentPosts: action,\n      getReceivedPosts: action,\n      handleSentOne: action.bound,\n      handleReceivedOne: action.bound,\n      sendComment: action\n    });\n  }\n\n  setSentPosts(data) {\n    this.sentPosts = data;\n  }\n\n  setReceivedPosts(data) {\n    this.receivedPosts = data;\n  }\n\n  setCurrentSentPost(data) {\n    this.currentSentPost = data;\n  }\n\n  setCurrentReceivedPost(data) {\n    this.currentReceivedPost = data;\n  }\n\n  async handlePost(content, setIsSent) {\n    try {\n      var _userStore$user, _userStore$user2;\n\n      if ((content === null || content === void 0 ? void 0 : content.length) === 0) {\n        return;\n      }\n\n      ;\n      const data = {\n        account: (_userStore$user = userStore.user) === null || _userStore$user === void 0 ? void 0 : _userStore$user.account,\n        nickName: (_userStore$user2 = userStore.user) === null || _userStore$user2 === void 0 ? void 0 : _userStore$user2.nickName,\n        content: content\n      };\n      const {\n        data: message\n      } = await postRespository.sendPost(data);\n      runInAction(() => {\n        if (message === 'Send Success') {\n          setIsSent();\n        }\n\n        ;\n      });\n    } catch (err) {\n      alert('서버가 점검중이에요');\n    }\n\n    ;\n  }\n\n  async getSentPosts() {\n    try {\n      var _userStore$user3;\n\n      const {\n        data: {\n          data\n        }\n      } = await postRespository.getSentPosts((_userStore$user3 = userStore.user) === null || _userStore$user3 === void 0 ? void 0 : _userStore$user3.account);\n      runInAction(() => {\n        this.setSentPosts(data);\n      });\n    } catch (err) {\n      console.log(err);\n      alert('오류가 발생하였습니다');\n      return;\n    }\n\n    ;\n  }\n\n  async getReceivedPosts() {\n    try {\n      var _userStore$user4;\n\n      const {\n        data\n      } = await postRespository.getReceivePosts((_userStore$user4 = userStore.user) === null || _userStore$user4 === void 0 ? void 0 : _userStore$user4.account);\n      runInAction(() => {\n        if (data) {\n          this.setReceivedPosts(data);\n          console.log(data);\n        }\n\n        ;\n      });\n    } catch (err) {\n      console.log(err);\n      alert('오류가 발생하였습니다');\n      return;\n    }\n\n    ;\n  }\n\n  handleSentOne(_id) {\n    const index = this.sentPosts.findIndex(x => x._id === _id);\n    index && this.setCurrentSentPost(this.sentPosts[index]);\n  }\n\n  handleReceivedOne(_id) {\n    const index = this.receivedPosts.findIndex(x => x._id === x._id);\n    console.log(index);\n    index && this.setCurrentReceivedPost(this.receivedPosts[index]);\n  }\n\n  async sendComment(content) {\n    try {\n      var _this$currentReceived, _this$currentReceived2, _userStore$user5;\n\n      if ((content === null || content === void 0 ? void 0 : content.length) === 0) {\n        return;\n      }\n\n      ;\n      const data = {\n        _id: (_this$currentReceived = this.currentReceivedPost) === null || _this$currentReceived === void 0 ? void 0 : _this$currentReceived._id,\n        toAccount: (_this$currentReceived2 = this.currentReceivedPost) === null || _this$currentReceived2 === void 0 ? void 0 : _this$currentReceived2.toAccount,\n        nickName: (_userStore$user5 = userStore.user) === null || _userStore$user5 === void 0 ? void 0 : _userStore$user5.nickName,\n        content: content\n      };\n      const {\n        data: {\n          message,\n          receivedPosts,\n          currentReceivedPost\n        }\n      } = await postRespository.sendComment(data);\n\n      if (message === 'Success') {\n        this.setReceivedPosts(receivedPosts);\n        this.setCurrentReceivedPost(currentReceivedPost);\n      }\n\n      ;\n    } catch (err) {\n      console.log(err);\n      alert('서버 점검중입니다');\n    }\n\n    ;\n  }\n\n}\n\n;\nconst postStore = new PostStore();\nexport default postStore;","map":{"version":3,"sources":["/Users/hyeonghan/VSCode/React/Serendy/client/src/store/postStore.ts"],"names":["action","makeObservable","observable","runInAction","userStore","postRespository","PostStore","constructor","sentPosts","receivedPosts","currentSentPost","currentReceivedPost","setSentPosts","setReceivedPosts","setCurrentSentPost","setCurrentReceivedPost","handlePost","getSentPosts","getReceivedPosts","handleSentOne","bound","handleReceivedOne","sendComment","data","content","setIsSent","length","account","user","nickName","message","sendPost","err","alert","console","log","getReceivePosts","_id","index","findIndex","x","toAccount","postStore"],"mappings":"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","sourcesContent":["import { action, makeObservable, observable, runInAction } from 'mobx';\nimport { ICurrentPost } from '../interfaces/index';\nimport userStore from './userStore';\nimport postRespository from '../repository/postRepository'\n\nclass PostStore {\n    public sentPosts: ICurrentPost[] = [];\n    public receivedPosts: ICurrentPost[] = [];\n    public currentSentPost: ICurrentPost | null = null\n    public currentReceivedPost: ICurrentPost | null = null;\n\n    constructor() {\n        makeObservable(this, {\n            sentPosts: observable,\n            receivedPosts: observable,\n            currentSentPost: observable,\n            currentReceivedPost: observable,\n            setSentPosts: action,\n            setReceivedPosts: action,\n            setCurrentSentPost: action,\n            setCurrentReceivedPost: action,\n            handlePost: action,\n            getSentPosts: action,\n            getReceivedPosts: action,\n            handleSentOne: action.bound,\n            handleReceivedOne: action.bound,\n            sendComment: action,\n        });\n    };\n\n    public setSentPosts(data: ICurrentPost[]): void {\n        this.sentPosts = data;\n    };\n\n    public setReceivedPosts(data: ICurrentPost[]): void {\n        this.receivedPosts = data;\n    };\n\n    public setCurrentSentPost(data: ICurrentPost): void {\n        this.currentSentPost = data;\n    };\n\n    public setCurrentReceivedPost(data: ICurrentPost): void {\n        this.currentReceivedPost = data;\n    };\n\n    public async handlePost(content: string | undefined, setIsSent: () => void): Promise<void> {\n        try {\n            if (content?.length === 0) {\n                return;\n            };\n            const data = {\n                account: userStore.user?.account,\n                nickName: userStore.user?.nickName,\n                content: content,\n            };\n            const { data: message } = await postRespository.sendPost(data);\n            runInAction(() => {\n                if ((message === 'Send Success')) {\n                    setIsSent();\n                };\n            })\n        } catch(err) {\n            alert('서버가 점검중이에요');\n        };\n    };\n\n    public async getSentPosts(): Promise<void> {\n        try {\n            const { data: { data }} = await postRespository.getSentPosts(userStore.user?.account);\n            runInAction(() => {\n                this.setSentPosts(data);\n            });\n        } catch(err) {\n            console.log(err);\n            alert('오류가 발생하였습니다');\n            return;\n        };\n    };\n\n    public async getReceivedPosts(): Promise<void> {\n        try {\n            const { data } = await postRespository.getReceivePosts(userStore.user?.account);\n            runInAction(() => {\n                if (data) {\n                    this.setReceivedPosts(data);\n                    console.log(data);\n                };\n            });\n        } catch(err) {\n            console.log(err);\n            alert('오류가 발생하였습니다');\n            return;\n        };\n    };\n\n    public handleSentOne(_id: string): void {\n        const index = this.sentPosts.findIndex(x => x._id === _id);\n        index && this.setCurrentSentPost(this.sentPosts[index]);\n    };\n\n    public handleReceivedOne(_id: string): void {\n        const index = this.receivedPosts.findIndex(x => x._id === x._id);\n        console.log(index);\n        index && this.setCurrentReceivedPost(this.receivedPosts[index]);\n    };\n\n    public async sendComment(content: string | undefined): Promise<void> {\n        try {\n            if (content?.length === 0) {\n                return;\n            };\n            const data = {\n                _id: this.currentReceivedPost?._id,\n                toAccount: this.currentReceivedPost?.toAccount,\n                nickName: userStore.user?.nickName,\n                content: content,\n            };\n            const { data: { message, receivedPosts, currentReceivedPost}} = await postRespository.sendComment(data);\n            if ((message === 'Success')) {\n                this.setReceivedPosts(receivedPosts);\n                this.setCurrentReceivedPost(currentReceivedPost);\n            };\n        } catch(err) {\n            console.log(err);\n            alert('서버 점검중입니다');\n        };\n    };\n};\n\nconst postStore = new PostStore();\nexport default postStore;"]},"metadata":{},"sourceType":"module"}