{"ast":null,"code":"var _jsxFileName = \"/Users/hyeonghan/VSCode/React/Serendy/client/src/components/ChatPage/ChatWindow.tsx\",\n    _s = $RefreshSig$();\n\nimport React, { useRef, useEffect } from 'react';\nimport styled from 'styled-components';\nimport { observer } from 'mobx-react';\nimport { zoomIn, zoomOut } from '../../style/keyframes';\nimport userStore from '../../store/userStore';\nimport chatStore from '../../store/chatStore';\nimport MessageBox from './MessageBox';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatWindow = observer(_c = _s(() => {\n  _s();\n\n  const sendBtn = useRef(null);\n  const input = useRef(null);\n  const screen = useRef(null);\n\n  const handleEnter = e => {\n    if (e.key === 'Enter') {\n      var _sendBtn$current;\n\n      (_sendBtn$current = sendBtn.current) === null || _sendBtn$current === void 0 ? void 0 : _sendBtn$current.click();\n    }\n\n    ;\n  };\n\n  const handleSendMsg = () => {\n    var _input$current;\n\n    if (((_input$current = input.current) === null || _input$current === void 0 ? void 0 : _input$current.value.length) !== 0) {\n      var _userStore$user, _input$current2, _userStore$userSocket;\n\n      const nickName = (_userStore$user = userStore.user) === null || _userStore$user === void 0 ? void 0 : _userStore$user.nickName;\n      const message = (_input$current2 = input.current) === null || _input$current2 === void 0 ? void 0 : _input$current2.value;\n      const data = {\n        nickName: nickName,\n        message: message\n      };\n      (_userStore$userSocket = userStore.userSocket) === null || _userStore$userSocket === void 0 ? void 0 : _userStore$userSocket.emit('chat', data);\n      input.current.value = '';\n    } else {\n      return;\n    }\n\n    ;\n  };\n\n  const scrollToBottom = () => {\n    var _screen$current, _screen$current2;\n\n    if (((_screen$current = screen.current) === null || _screen$current === void 0 ? void 0 : _screen$current.scrollHeight) && ((_screen$current2 = screen.current) === null || _screen$current2 === void 0 ? void 0 : _screen$current2.clientHeight)) {\n      var _screen$current3;\n\n      const scroll = screen.current.scrollHeight - screen.current.clientHeight;\n      (_screen$current3 = screen.current) === null || _screen$current3 === void 0 ? void 0 : _screen$current3.scrollTo(0, scroll);\n    } else {\n      return;\n    }\n\n    ;\n  };\n\n  useEffect(() => {\n    chatStore.handleMatched();\n    chatStore.handleReceiveMsg();\n    chatStore.chatStopped(); // 상대방이 대화종료를 했을때\n  }, []); // eslint-disable-line\n\n  useEffect(() => {\n    return () => {\n      chatStore.stopChat();\n    };\n  }, []); // eslint-disable-line\n\n  useEffect(() => {\n    chatStore.handlePushChat();\n    console.log('ddd');\n    console.log(chatStore.recentChat);\n    return () => {\n      chatStore.resetRecentChat();\n      console.log(chatStore.recentChat);\n      scrollToBottom();\n    };\n  }, [chatStore.recentChat.message]); // eslint-disable-line\n\n  return /*#__PURE__*/_jsxDEV(ChatBox, {\n    animation: chatStore.isMatched ? zoomIn : zoomOut,\n    visibility: chatStore.visible,\n    children: [/*#__PURE__*/_jsxDEV(Screen, {\n      ref: screen,\n      children: chatStore.chatLog.map((data, i) => /*#__PURE__*/_jsxDEV(MessageBox, {\n        message: data.message,\n        nickName: data.nickName,\n        socketID: data.socketID === userStore.socketID\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(SenderBox, {\n      children: [/*#__PURE__*/_jsxDEV(Input, {\n        ref: input,\n        onKeyPress: handleEnter\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(SendBtn, {\n        ref: sendBtn,\n        onClick: handleSendMsg,\n        disabled: chatStore.isFinished ? true : false,\n        children: \"\\uC804\\uC1A1\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 68,\n    columnNumber: 9\n  }, this);\n}, \"lWwJF4VaPdfMFjLr2tuge69PW/E=\"));\n_c2 = ChatWindow;\nexport default ChatWindow;\nconst ChatBox = styled.div`\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    margin-right: 20px;\n    width: 100%;\n    height: 740px;\n    min-height: 740px;\n    visibility: ${({\n  visibility\n}) => visibility};\n    animation: ${({\n  animation\n}) => animation} .7s ease forwards;\n    @media only screen and (max-width: 1450px) {\n        margin-right: 0px;\n        min-height: 340px;\n    };\n    @media only screen and (max-width: 600px) {\n        height: 100%;\n    };\n`;\n_c3 = ChatBox;\nconst Screen = styled.div`\n    width: 740px;\n    height: 680px;\n    max-height: 680px;\n    background-color: ${({\n  theme\n}) => theme.colors.white10};\n    border-radius: 10px;\n    overflow-y: auto;\n    @media only screen and (max-width: 1450px) {\n        width: 99%;\n        height: 70%;\n        min-width: 300px;\n    };\n`;\n_c4 = Screen;\nconst SenderBox = styled.div`\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 10px;\n    width: 740px;\n    min-width: 500px;\n    height: 50px;\n    @media only screen and (max-width: 1450px) {\n        width: 99%;\n        min-width: 200px;\n    };\n`;\n_c5 = SenderBox;\nconst Input = styled.input.attrs({\n  type: 'text',\n  placeholder: '내용을 입력해주세요',\n  autocomplete: 'off'\n})`\n    all: unset;\n    width: 84%;\n    min-height: 50px;\n    padding-left: 30px;\n    font-size: 18px;\n    color: ${({\n  theme\n}) => theme.colors.white};\n    background-color: ${({\n  theme\n}) => theme.colors.white10};\n    border-radius: 10px;\n    @media only screen and (max-width: 600px) {\n        width: 70%;\n        font-size: 15px;\n    };\n`;\n_c6 = Input;\nconst SendBtn = styled.button`\n    all: unset;\n    width: 10%;\n    height: 50px;\n    font-size: 18px;\n    text-align: center;\n    background-color: ${({\n  theme\n}) => theme.colors.main60};\n    border-radius: 10px;\n    color: ${({\n  theme\n}) => theme.colors.white};\n    cursor: pointer;\n    transition: .3s ease;\n    &:hover {\n        background-color: ${({\n  theme\n}) => theme.colors.plum};\n        color: ${({\n  theme\n}) => theme.colors.black};\n    }\n    @media only screen and (max-width: 1450px) {\n        font-size: 15px;\n        width: 10%;\n    };\n    @media only screen and (max-width: 600px) {\n        width: 18%;\n    };\n`;\n_c7 = SendBtn;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7;\n\n$RefreshReg$(_c, \"ChatWindow$observer\");\n$RefreshReg$(_c2, \"ChatWindow\");\n$RefreshReg$(_c3, \"ChatBox\");\n$RefreshReg$(_c4, \"Screen\");\n$RefreshReg$(_c5, \"SenderBox\");\n$RefreshReg$(_c6, \"Input\");\n$RefreshReg$(_c7, \"SendBtn\");","map":{"version":3,"sources":["/Users/hyeonghan/VSCode/React/Serendy/client/src/components/ChatPage/ChatWindow.tsx"],"names":["React","useRef","useEffect","styled","observer","zoomIn","zoomOut","userStore","chatStore","MessageBox","ChatWindow","sendBtn","input","screen","handleEnter","e","key","current","click","handleSendMsg","value","length","nickName","user","message","data","userSocket","emit","scrollToBottom","scrollHeight","clientHeight","scroll","scrollTo","handleMatched","handleReceiveMsg","chatStopped","stopChat","handlePushChat","console","log","recentChat","resetRecentChat","isMatched","visible","chatLog","map","i","socketID","isFinished","ChatBox","div","visibility","animation","Screen","theme","colors","white10","SenderBox","Input","attrs","type","placeholder","autocomplete","white","SendBtn","button","main60","plum","black"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from 'react'\nimport styled, { Keyframes } from 'styled-components'\nimport { observer } from 'mobx-react'\nimport { VisibilityType } from '../../interfaces'\nimport { zoomIn, zoomOut } from '../../style/keyframes'\nimport userStore from '../../store/userStore'\nimport chatStore from '../../store/chatStore'\nimport MessageBox from './MessageBox'\nimport { toJS } from 'mobx'\n\nconst ChatWindow: React.FC = observer(() => {\n    const sendBtn = useRef<HTMLButtonElement>(null);\n    const input = useRef<HTMLInputElement>(null);\n    const screen = useRef<HTMLDivElement>(null);\n\n    const handleEnter = (e: React.KeyboardEvent): void => {\n        if (e.key === 'Enter') {\n            sendBtn.current?.click();\n        };\n    };\n\n    const handleSendMsg = (): void => {\n        if (input.current?.value.length !== 0) {\n            const nickName = userStore.user?.nickName;\n            const message = input.current?.value;\n            const data = { nickName: nickName, message: message };\n            userStore.userSocket?.emit('chat', data);\n            input.current!.value = '';\n        } else {\n            return;\n        };\n    };\n\n    const scrollToBottom = (): void => {\n        if (screen.current?.scrollHeight && screen.current?.clientHeight) {\n            const scroll = screen.current.scrollHeight - screen.current.clientHeight;\n            screen.current?.scrollTo(0, scroll);\n        } else {\n            return;\n        };\n    };\n\n    useEffect(() => {\n        chatStore.handleMatched();\n        chatStore.handleReceiveMsg();\n        chatStore.chatStopped(); // 상대방이 대화종료를 했을때\n    }, []); // eslint-disable-line\n\n    useEffect(() => { \n        return () => {\n            chatStore.stopChat();\n        };\n    }, []); // eslint-disable-line\n\n    useEffect(() => {\n        chatStore.handlePushChat();\n        console.log('ddd')\n        console.log(chatStore.recentChat);\n        return () => {\n            chatStore.resetRecentChat();\n            console.log(chatStore.recentChat);\n\n            scrollToBottom();\n        };\n    }, [chatStore.recentChat.message]); // eslint-disable-line\n\n    return (\n        <ChatBox animation={chatStore.isMatched ? zoomIn : zoomOut}\n            visibility={chatStore.visible}\n        >\n            <Screen ref={screen} >\n                {chatStore.chatLog.map((data, i) => (\n                    <MessageBox message={data.message}\n                        nickName={data.nickName}\n                        socketID={data.socketID === userStore.socketID}\n                        key={i}\n                    />\n                ))}\n            </Screen>\n            <SenderBox>\n                <Input ref={input}\n                    onKeyPress={handleEnter}\n                />\n                <SendBtn ref={sendBtn}\n                    onClick={handleSendMsg}\n                    disabled={chatStore.isFinished ? true : false}\n                >\n                    전송\n                </SendBtn>\n            </SenderBox>\n        </ChatBox>\n    );\n});\n\nexport default ChatWindow;\n\nconst ChatBox = styled.div<{ animation: Keyframes, visibility: VisibilityType }>`\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    margin-right: 20px;\n    width: 100%;\n    height: 740px;\n    min-height: 740px;\n    visibility: ${({ visibility }) => visibility};\n    animation: ${({ animation }) => animation} .7s ease forwards;\n    @media only screen and (max-width: 1450px) {\n        margin-right: 0px;\n        min-height: 340px;\n    };\n    @media only screen and (max-width: 600px) {\n        height: 100%;\n    };\n`;\n\nconst Screen = styled.div`\n    width: 740px;\n    height: 680px;\n    max-height: 680px;\n    background-color: ${({ theme }) => theme.colors.white10};\n    border-radius: 10px;\n    overflow-y: auto;\n    @media only screen and (max-width: 1450px) {\n        width: 99%;\n        height: 70%;\n        min-width: 300px;\n    };\n`;\n\nconst SenderBox = styled.div`\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 10px;\n    width: 740px;\n    min-width: 500px;\n    height: 50px;\n    @media only screen and (max-width: 1450px) {\n        width: 99%;\n        min-width: 200px;\n    };\n`;\n\nconst Input = styled.input.attrs(({\n    type: 'text',\n    placeholder: '내용을 입력해주세요',\n    autocomplete: 'off',\n}))`\n    all: unset;\n    width: 84%;\n    min-height: 50px;\n    padding-left: 30px;\n    font-size: 18px;\n    color: ${({ theme }) => theme.colors.white};\n    background-color: ${({ theme }) => theme.colors.white10};\n    border-radius: 10px;\n    @media only screen and (max-width: 600px) {\n        width: 70%;\n        font-size: 15px;\n    };\n`;\n\nconst SendBtn = styled.button`\n    all: unset;\n    width: 10%;\n    height: 50px;\n    font-size: 18px;\n    text-align: center;\n    background-color: ${({ theme }) => theme.colors.main60};\n    border-radius: 10px;\n    color: ${({ theme }) => theme.colors.white};\n    cursor: pointer;\n    transition: .3s ease;\n    &:hover {\n        background-color: ${({ theme }) => theme.colors.plum};\n        color: ${({ theme }) => theme.colors.black};\n    }\n    @media only screen and (max-width: 1450px) {\n        font-size: 15px;\n        width: 10%;\n    };\n    @media only screen and (max-width: 600px) {\n        width: 18%;\n    };\n`;"]},"metadata":{},"sourceType":"module"}