{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/hyeonghan/VSCode/React/Serendy/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5;import React,{useRef,useEffect}from'react';import styled from'styled-components';import{observer}from'mobx-react';import{zoomIn,zoomOut}from'../../style/keyframes';import userStore from'../../store/userStore';import chatStore from'../../store/chatStore';import MessageBox from'./MessageBox';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var ChatWindow=observer(function(){var sendBtn=useRef(null);var input=useRef(null);var screen=useRef(null);var resetInput=function resetInput(){input.current.value='';};var handleEnter=function handleEnter(e){if(e.key==='Enter'){var _sendBtn$current;(_sendBtn$current=sendBtn.current)===null||_sendBtn$current===void 0?void 0:_sendBtn$current.click();};};var handleSendMsg=function handleSendMsg(){var _input$current;if(((_input$current=input.current)===null||_input$current===void 0?void 0:_input$current.value.length)!==0){var _userStore$user,_input$current2,_userStore$userSocket;var nickName=(_userStore$user=userStore.user)===null||_userStore$user===void 0?void 0:_userStore$user.nickName;var message=(_input$current2=input.current)===null||_input$current2===void 0?void 0:_input$current2.value;var data={nickName:nickName,message:message};(_userStore$userSocket=userStore.userSocket)===null||_userStore$userSocket===void 0?void 0:_userStore$userSocket.emit('chat',data);input.current.value='';}else{return;};};var scrollToBottom=function scrollToBottom(){var _screen$current,_screen$current2;if(((_screen$current=screen.current)===null||_screen$current===void 0?void 0:_screen$current.scrollHeight)&&((_screen$current2=screen.current)===null||_screen$current2===void 0?void 0:_screen$current2.clientHeight)){var _screen$current3;var scroll=screen.current.scrollHeight-screen.current.clientHeight;(_screen$current3=screen.current)===null||_screen$current3===void 0?void 0:_screen$current3.scrollTo(0,scroll);}else{return;};};useEffect(function(){chatStore.handleMatched();chatStore.handleReceiveMsg();chatStore.chatStopped();},[]);// eslint-disable-line\nuseEffect(function(){resetInput();},[chatStore.isFinished]);// eslint-disable-line\nuseEffect(function(){return function(){chatStore.stopChat();chatStore.reset();};},[]);// eslint-disable-line\nuseEffect(function(){chatStore.handlePushChat();scrollToBottom();chatStore.resetRecentChat();},[chatStore.recentChat.message]);// eslint-disable-line\nreturn/*#__PURE__*/_jsxs(ChatBox,{animation:chatStore.isMatched?zoomIn:zoomOut,visibility:chatStore.visible,children:[/*#__PURE__*/_jsx(Screen,{ref:screen,children:chatStore.chatLog.map(function(data,i){return/*#__PURE__*/_jsx(MessageBox,{message:data.message,nickName:data.nickName,socketID:data.socketID===userStore.socketID},i);})}),/*#__PURE__*/_jsxs(SenderBox,{children:[/*#__PURE__*/_jsx(Input,{ref:input,onKeyPress:handleEnter}),/*#__PURE__*/_jsx(SendBtn,{ref:sendBtn,onClick:handleSendMsg,disabled:chatStore.isFinished?true:false,children:\"\\uC804\\uC1A1\"})]})]});});export default ChatWindow;var ChatBox=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n    display: flex;\\n    flex-direction: column;\\n    justify-content: center;\\n    align-items: center;\\n    margin-right: 20px;\\n    width: 100%;\\n    height: 740px;\\n    min-height: 740px;\\n    visibility: \",\";\\n    animation: \",\" .7s ease forwards;\\n    @media only screen and (max-width: 1450px) {\\n        margin-right: 0px;\\n        min-height: 340px;\\n    };\\n    @media only screen and (max-width: 600px) {\\n        height: 100%;\\n    };\\n\"])),function(_ref){var visibility=_ref.visibility;return visibility;},function(_ref2){var animation=_ref2.animation;return animation;});var Screen=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n    width: 740px;\\n    height: 680px;\\n    max-height: 680px;\\n    background-color: \",\";\\n    border-radius: 10px;\\n    overflow-y: auto;\\n    @media only screen and (max-width: 1450px) {\\n        width: 99%;\\n        height: 70%;\\n        min-width: 300px;\\n    };\\n\"])),function(_ref3){var theme=_ref3.theme;return theme.colors.white10;});var SenderBox=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n    display: flex;\\n    justify-content: space-between;\\n    align-items: center;\\n    margin-top: 10px;\\n    width: 740px;\\n    min-width: 500px;\\n    height: 50px;\\n    @media only screen and (max-width: 1450px) {\\n        width: 99%;\\n        min-width: 200px;\\n    };\\n\"])));var Input=styled.input.attrs({type:'text',placeholder:'내용을 입력해주세요',autocomplete:'off'})(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n    all: unset;\\n    width: 84%;\\n    min-height: 50px;\\n    padding-left: 30px;\\n    font-size: 18px;\\n    color: \",\";\\n    background-color: \",\";\\n    border-radius: 10px;\\n    @media only screen and (max-width: 600px) {\\n        width: 70%;\\n        font-size: 15px;\\n    };\\n\"])),function(_ref4){var theme=_ref4.theme;return theme.colors.white;},function(_ref5){var theme=_ref5.theme;return theme.colors.white10;});var SendBtn=styled.button(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n    all: unset;\\n    width: 10%;\\n    height: 50px;\\n    font-size: 18px;\\n    text-align: center;\\n    background-color: \",\";\\n    border-radius: 10px;\\n    color: \",\";\\n    cursor: pointer;\\n    transition: .3s ease;\\n    &:hover {\\n        background-color: \",\";\\n        color: \",\";\\n    }\\n    @media only screen and (max-width: 1450px) {\\n        font-size: 15px;\\n        width: 10%;\\n    };\\n    @media only screen and (max-width: 600px) {\\n        width: 18%;\\n    };\\n\"])),function(_ref6){var theme=_ref6.theme;return theme.colors.main60;},function(_ref7){var theme=_ref7.theme;return theme.colors.white;},function(_ref8){var theme=_ref8.theme;return theme.colors.plum;},function(_ref9){var theme=_ref9.theme;return theme.colors.black;});","map":{"version":3,"sources":["/Users/hyeonghan/VSCode/React/Serendy/client/src/components/ChatPage/ChatWindow.tsx"],"names":["React","useRef","useEffect","styled","observer","zoomIn","zoomOut","userStore","chatStore","MessageBox","ChatWindow","sendBtn","input","screen","resetInput","current","value","handleEnter","e","key","click","handleSendMsg","length","nickName","user","message","data","userSocket","emit","scrollToBottom","scrollHeight","clientHeight","scroll","scrollTo","handleMatched","handleReceiveMsg","chatStopped","isFinished","stopChat","reset","handlePushChat","resetRecentChat","recentChat","isMatched","visible","chatLog","map","i","socketID","ChatBox","div","visibility","animation","Screen","theme","colors","white10","SenderBox","Input","attrs","type","placeholder","autocomplete","white","SendBtn","button","main60","plum","black"],"mappings":"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","sourcesContent":["import React, { useRef, useEffect } from 'react'\nimport styled, { Keyframes } from 'styled-components'\nimport { observer } from 'mobx-react'\nimport { VisibilityType } from '../../interfaces'\nimport { zoomIn, zoomOut } from '../../style/keyframes'\nimport userStore from '../../store/userStore'\nimport chatStore from '../../store/chatStore'\nimport MessageBox from './MessageBox'\n\nconst ChatWindow: React.FC = observer(() => {\n    const sendBtn = useRef<HTMLButtonElement>(null);\n    const input = useRef<HTMLInputElement>(null);\n    const screen = useRef<HTMLDivElement>(null);\n\n    const resetInput = (): void => {\n        input.current!.value = '';\n    };\n\n    const handleEnter = (e: React.KeyboardEvent): void => {\n        if (e.key === 'Enter') {\n            sendBtn.current?.click();\n        };\n    };\n\n    const handleSendMsg = (): void => {\n        if (input.current?.value.length !== 0) {\n            const nickName = userStore.user?.nickName;\n            const message = input.current?.value;\n            const data = { nickName, message };\n            userStore.userSocket?.emit('chat', data);\n            input.current!.value = '';\n        } else {\n            return;\n        };\n    };\n\n    const scrollToBottom = (): void => {\n        if (screen.current?.scrollHeight && screen.current?.clientHeight) {\n            const scroll = screen.current.scrollHeight - screen.current.clientHeight;\n            screen.current?.scrollTo(0, scroll);\n        } else {\n            return;\n        };\n    };\n\n    useEffect(() => {\n        chatStore.handleMatched();\n        chatStore.handleReceiveMsg();\n        chatStore.chatStopped();\n    }, []); // eslint-disable-line\n\n    useEffect(() => {\n        resetInput();\n    }, [chatStore.isFinished]) // eslint-disable-line\n\n    useEffect(() => {\n        return () => {\n            chatStore.stopChat();\n            chatStore.reset();\n        }\n    }, []); // eslint-disable-line\n\n    useEffect(() => {\n        chatStore.handlePushChat();\n        scrollToBottom();\n        chatStore.resetRecentChat();\n    }, [chatStore.recentChat.message]); // eslint-disable-line\n\n    return (\n        <ChatBox animation={chatStore.isMatched ? zoomIn : zoomOut}\n            visibility={chatStore.visible}\n        >\n            <Screen ref={screen} >\n                {chatStore.chatLog.map((data, i) => (\n                    <MessageBox message={data.message}\n                        nickName={data.nickName}\n                        socketID={data.socketID === userStore.socketID}\n                        key={i}\n                    />\n                ))}\n            </Screen>\n            <SenderBox>\n                <Input ref={input}\n                    onKeyPress={handleEnter}\n                />\n                <SendBtn ref={sendBtn}\n                    onClick={handleSendMsg}\n                    disabled={chatStore.isFinished ? true : false}\n                >\n                    전송\n                </SendBtn>\n            </SenderBox>\n        </ChatBox>\n    );\n});\n\nexport default ChatWindow;\n\nconst ChatBox = styled.div<{ animation: Keyframes, visibility: VisibilityType }>`\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    margin-right: 20px;\n    width: 100%;\n    height: 740px;\n    min-height: 740px;\n    visibility: ${({ visibility }) => visibility};\n    animation: ${({ animation }) => animation} .7s ease forwards;\n    @media only screen and (max-width: 1450px) {\n        margin-right: 0px;\n        min-height: 340px;\n    };\n    @media only screen and (max-width: 600px) {\n        height: 100%;\n    };\n`;\n\nconst Screen = styled.div`\n    width: 740px;\n    height: 680px;\n    max-height: 680px;\n    background-color: ${({ theme }) => theme.colors.white10};\n    border-radius: 10px;\n    overflow-y: auto;\n    @media only screen and (max-width: 1450px) {\n        width: 99%;\n        height: 70%;\n        min-width: 300px;\n    };\n`;\n\nconst SenderBox = styled.div`\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-top: 10px;\n    width: 740px;\n    min-width: 500px;\n    height: 50px;\n    @media only screen and (max-width: 1450px) {\n        width: 99%;\n        min-width: 200px;\n    };\n`;\n\nconst Input = styled.input.attrs(({\n    type: 'text',\n    placeholder: '내용을 입력해주세요',\n    autocomplete: 'off',\n}))`\n    all: unset;\n    width: 84%;\n    min-height: 50px;\n    padding-left: 30px;\n    font-size: 18px;\n    color: ${({ theme }) => theme.colors.white};\n    background-color: ${({ theme }) => theme.colors.white10};\n    border-radius: 10px;\n    @media only screen and (max-width: 600px) {\n        width: 70%;\n        font-size: 15px;\n    };\n`;\n\nconst SendBtn = styled.button`\n    all: unset;\n    width: 10%;\n    height: 50px;\n    font-size: 18px;\n    text-align: center;\n    background-color: ${({ theme }) => theme.colors.main60};\n    border-radius: 10px;\n    color: ${({ theme }) => theme.colors.white};\n    cursor: pointer;\n    transition: .3s ease;\n    &:hover {\n        background-color: ${({ theme }) => theme.colors.plum};\n        color: ${({ theme }) => theme.colors.black};\n    }\n    @media only screen and (max-width: 1450px) {\n        font-size: 15px;\n        width: 10%;\n    };\n    @media only screen and (max-width: 600px) {\n        width: 18%;\n    };\n`;"]},"metadata":{},"sourceType":"module"}