{"ast":null,"code":"import { action, computed, makeObservable, observable } from \"mobx\";\nimport serendyRepository from '../repository/serendyRepository';\n\nclass AuthStore {\n  constructor() {\n    this._isSignIn = false;\n    this._user = null;\n    this._isLogging = false;\n    makeObservable(this, {\n      _isLogging: observable,\n      _isSignIn: observable,\n      _user: observable,\n      isLogging: computed,\n      isSignIn: computed,\n      user: computed,\n      setIsSignIn: action.bound,\n      setUser: action,\n      signInWithToken: action.bound,\n      signIn: action.bound,\n      signOut: action.bound\n    });\n  }\n\n  get isSignIn() {\n    return this._isSignIn;\n  }\n\n  get user() {\n    return this._user;\n  }\n\n  get isLogging() {\n    return this._isLogging;\n  }\n\n  setIsSignIn() {\n    this._isSignIn = true;\n  }\n\n  setUser(user) {\n    this._user = user;\n  }\n\n  setIsLogging() {\n    this._isLogging = true;\n  }\n\n  async signInWithToken() {\n    this.setIsLogging();\n    const token = localStorage.getItem('SerendyToken');\n    console.log(token);\n\n    if (!token) {\n      console.log('no token');\n      return;\n    } else if (token) {\n      const response = await serendyRepository.signInWidthToken();\n      console.log(response);\n\n      if (response.data.message === 'Invalid Token') {\n        return;\n      } else if (response.data.message === 'SignIn Success') {\n        console.log('signin success');\n        this.setUser(response.data.nickName);\n        this.setIsSignIn();\n      }\n    }\n  }\n\n  async signIn(userData, setError, push) {\n    try {\n      const response = await serendyRepository.signIn(userData);\n\n      if (response.data.message === 'SignIn Fail') {\n        setError();\n      } else if (response.data.message === 'SignIn Success') {\n        this.setUser(response.data.nickName);\n        this.setIsSignIn();\n        localStorage.setItem('SerendyToken', response.data.token);\n        push();\n      }\n    } catch (err) {\n      alert('현재 서버가 점검중입니다');\n    }\n  }\n\n  signOut(push) {\n    this._isSignIn = false;\n    this._user = null;\n    localStorage.removeItem('SerendyToken');\n    push();\n  }\n\n}\n\nconst authStore = new AuthStore();\nexport default authStore;","map":{"version":3,"sources":["/Users/hyeonghan/VSCode/React/Serendy/client/src/store/authStore.ts"],"names":["action","computed","makeObservable","observable","serendyRepository","AuthStore","constructor","_isSignIn","_user","_isLogging","isLogging","isSignIn","user","setIsSignIn","bound","setUser","signInWithToken","signIn","signOut","setIsLogging","token","localStorage","getItem","console","log","response","signInWidthToken","data","message","nickName","userData","setError","push","setItem","err","alert","removeItem","authStore"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,QAAjB,EAA2BC,cAA3B,EAA2CC,UAA3C,QAA6D,MAA7D;AAEA,OAAOC,iBAAP,MAA8B,iCAA9B;;AAYA,MAAMC,SAAN,CAAsC;AAMlCC,EAAAA,WAAW,GAAG;AAAA,SAJNC,SAIM,GAJe,KAIf;AAAA,SAHNC,KAGM,GAHgB,IAGhB;AAAA,SAFNC,UAEM,GAFgB,KAEhB;AACVP,IAAAA,cAAc,CAAkD,IAAlD,EAAwD;AAClEO,MAAAA,UAAU,EAAEN,UADsD;AAElEI,MAAAA,SAAS,EAAEJ,UAFuD;AAGlEK,MAAAA,KAAK,EAAEL,UAH2D;AAIlEO,MAAAA,SAAS,EAAET,QAJuD;AAKlEU,MAAAA,QAAQ,EAAEV,QALwD;AAMlEW,MAAAA,IAAI,EAAEX,QAN4D;AAOlEY,MAAAA,WAAW,EAAEb,MAAM,CAACc,KAP8C;AAQlEC,MAAAA,OAAO,EAAEf,MARyD;AASlEgB,MAAAA,eAAe,EAAEhB,MAAM,CAACc,KAT0C;AAUlEG,MAAAA,MAAM,EAAEjB,MAAM,CAACc,KAVmD;AAWlEI,MAAAA,OAAO,EAAElB,MAAM,CAACc;AAXkD,KAAxD,CAAd;AAaH;;AAEW,MAARH,QAAQ,GAAY;AACpB,WAAO,KAAKJ,SAAZ;AACH;;AAEO,MAAJK,IAAI,GAAiB;AACrB,WAAO,KAAKJ,KAAZ;AACH;;AAEY,MAATE,SAAS,GAAY;AACrB,WAAO,KAAKD,UAAZ;AACH;;AAEDI,EAAAA,WAAW,GAAS;AAChB,SAAKN,SAAL,GAAiB,IAAjB;AACH;;AAEDQ,EAAAA,OAAO,CAACH,IAAD,EAAoB;AACvB,SAAKJ,KAAL,GAAaI,IAAb;AACH;;AAEDO,EAAAA,YAAY,GAAS;AACjB,SAAKV,UAAL,GAAkB,IAAlB;AACH;;AAEoB,QAAfO,eAAe,GAAG;AACpB,SAAKG,YAAL;AACA,UAAMC,KAAK,GAAGC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAd;AACAC,IAAAA,OAAO,CAACC,GAAR,CAAYJ,KAAZ;;AACA,QAAI,CAACA,KAAL,EAAY;AACRG,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACA;AACH,KAHD,MAGO,IAAIJ,KAAJ,EAAW;AACd,YAAMK,QAAQ,GAAG,MAAMrB,iBAAiB,CAACsB,gBAAlB,EAAvB;AACAH,MAAAA,OAAO,CAACC,GAAR,CAAYC,QAAZ;;AACA,UAAKA,QAAQ,CAACE,IAAT,CAAcC,OAAd,KAA0B,eAA/B,EAAiD;AAC7C;AACH,OAFD,MAEO,IAAKH,QAAQ,CAACE,IAAT,CAAcC,OAAd,KAA0B,gBAA/B,EAAkD;AACrDL,QAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ;AACA,aAAKT,OAAL,CAAaU,QAAQ,CAACE,IAAT,CAAcE,QAA3B;AACA,aAAKhB,WAAL;AACH;AACJ;AACJ;;AAEW,QAANI,MAAM,CAACa,QAAD,EAAwBC,QAAxB,EAA8CC,IAA9C,EAA+E;AACvF,QAAI;AACA,YAAMP,QAAQ,GAAG,MAAMrB,iBAAiB,CAACa,MAAlB,CAAyBa,QAAzB,CAAvB;;AACA,UAAKL,QAAQ,CAACE,IAAT,CAAcC,OAAd,KAA0B,aAA/B,EAA+C;AAC3CG,QAAAA,QAAQ;AACX,OAFD,MAEO,IAAKN,QAAQ,CAACE,IAAT,CAAcC,OAAd,KAA0B,gBAA/B,EAAkD;AACrD,aAAKb,OAAL,CAAaU,QAAQ,CAACE,IAAT,CAAcE,QAA3B;AACA,aAAKhB,WAAL;AACAQ,QAAAA,YAAY,CAACY,OAAb,CAAqB,cAArB,EAAqCR,QAAQ,CAACE,IAAT,CAAcP,KAAnD;AACAY,QAAAA,IAAI;AACP;AACJ,KAVD,CAUE,OAAME,GAAN,EAAW;AACTC,MAAAA,KAAK,CAAC,eAAD,CAAL;AACH;AACJ;;AAEDjB,EAAAA,OAAO,CAACc,IAAD,EAAyB;AAC5B,SAAKzB,SAAL,GAAiB,KAAjB;AACA,SAAKC,KAAL,GAAa,IAAb;AACAa,IAAAA,YAAY,CAACe,UAAb,CAAwB,cAAxB;AACAJ,IAAAA,IAAI;AACP;;AAvFiC;;AA0FtC,MAAMK,SAAS,GAAG,IAAIhC,SAAJ,EAAlB;AACA,eAAegC,SAAf","sourcesContent":["import { action, computed, makeObservable, observable } from \"mobx\";\nimport { ISignInData } from '../components/SignIn/SignInBox';\nimport serendyRepository from '../repository/serendyRepository';\n\ninterface IUser {\n    nickName: string;\n}\n\ninterface IAuthStore {\n    isLogging: boolean;\n    isSignIn: boolean;\n    user: IUser | null;\n}\n\nclass AuthStore implements IAuthStore {\n\n    private _isSignIn: boolean = false;\n    private _user: IUser | null = null;\n    private _isLogging: boolean = false;\n\n    constructor() {\n        makeObservable<AuthStore, '_isLogging' | '_isSignIn' | '_user'>(this, {\n            _isLogging: observable,\n            _isSignIn: observable,\n            _user: observable,\n            isLogging: computed,\n            isSignIn: computed,\n            user: computed,\n            setIsSignIn: action.bound,\n            setUser: action,\n            signInWithToken: action.bound,\n            signIn: action.bound,\n            signOut: action.bound,\n        })\n    }\n\n    get isSignIn(): boolean {\n        return this._isSignIn;\n    }\n\n    get user(): IUser | null {\n        return this._user;\n    }\n\n    get isLogging(): boolean {\n        return this._isLogging;\n    }\n\n    setIsSignIn(): void {\n        this._isSignIn = true;\n    }\n\n    setUser(user: IUser): void {\n        this._user = user;\n    }\n\n    setIsLogging(): void {\n        this._isLogging = true;\n    }\n\n    async signInWithToken() {\n        this.setIsLogging();\n        const token = localStorage.getItem('SerendyToken');\n        console.log(token);\n        if (!token) {\n            console.log('no token');\n            return;\n        } else if (token) {\n            const response = await serendyRepository.signInWidthToken();\n            console.log(response);\n            if ((response.data.message === 'Invalid Token')) {\n                return;\n            } else if ((response.data.message === 'SignIn Success')) {\n                console.log('signin success')\n                this.setUser(response.data.nickName);\n                this.setIsSignIn();\n            }\n        }\n    }\n\n    async signIn(userData: ISignInData, setError: () => void, push: () => void): Promise<void> {\n        try {\n            const response = await serendyRepository.signIn(userData);\n            if ((response.data.message === 'SignIn Fail')) {\n                setError();\n            } else if ((response.data.message === 'SignIn Success')) {\n                this.setUser(response.data.nickName);\n                this.setIsSignIn();\n                localStorage.setItem('SerendyToken', response.data.token);\n                push();\n            }\n        } catch(err) {\n            alert('현재 서버가 점검중입니다');\n        }\n    }\n\n    signOut(push: () => void): void {\n        this._isSignIn = false;\n        this._user = null;\n        localStorage.removeItem('SerendyToken');\n        push();\n    }\n}\n\nconst authStore = new AuthStore();\nexport default authStore;"]},"metadata":{},"sourceType":"module"}